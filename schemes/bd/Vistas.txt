CREATE OR REPLACE VIEW ADM_INFI.INFI_TB_100_TITULOS
(TITULO_ID, TITULO_ISIN, TITULO_VALOR_NOMINAL, TITULO_MONEDA_DEN, DENOM, 
 TITULO_DESCRIPCION, BASIS, COUPRATE_8, INTCALCRULE, INTPAYCYCLE, 
 INTPAYRULE, ISSDATE, TITULO_FE_VENCIMIENTO, TITULO_FE_EMISION, TITULO_MONEDA_NEG, 
 INTCCY, TITULOS_PRECIO_MERCADO)
AS 
select TRIM(A.SECID) AS TITULO_ID,b.SECID AS TITULO_ISIN,
1 as TITULO_VALOR_NOMINAL,
"CCY" as TITULO_MONEDA_DEN,"DENOM","DESCR" as TITULO_DESCRIPCION,"BASIS","COUPRATE_8","INTCALCRULE","INTPAYCYCLE","INTPAYRULE","ISSDATE",
"MDATE" as TITULO_FE_VENCIMIENTO,
"VDATE" as TITULO_FE_EMISION,"SETTCCY" as TITULO_MONEDA_NEG,
"INTCCY",b.TITULOS_PRECIO_MERCADO
from
secm a, INFI_VI_PRECIO_MERCADO b
where trim(a.SECID) = trim(b.SECID(+))
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_100_TITULOS
(SECID, ACCTNGTYPE, CALLDATE, CALLPRICE_8, CLSGINDXRATE_8, 
 CONVCOUPRATE_8, CONVDATE, COUPONNO, COUPRATE_8, COUPENDDATE, 
 CCY, DENOM, DESCR, ENDTIME, FIRSTIPAYDATE, 
 FIXCCY, GUARANTOR, INFRATECODE, INITINDEXRATE_8, BASIS, 
 INTCALCRULE, INTPAYCYCLE, INTPAYRULE, RATECODE, ISSDATE, 
 ISSUER, LASTIPAYDATE, LSTMNTDATE, MARKMAKIND, MDATE, 
 MUTFUNDIND, NORMCOUPPERIOD, PARAMT, PRICEDECS, PRICERNDRULE, 
 PRODUCT, PRODTYPE, PUTDATE, PUTPRICE_8, RATEDECS, 
 RATERNDRULE, RATETOL, REDEMPAMT, REPOCOLLPCT, SERIES, 
 SETTDAYS, SPREADRATE_8, STARTTIME, SYMBOLID, TAXIND, 
 TENOR, TRADSTAT, SECUNIT, VDATE, EXCHCNO, 
 WHACCNO, SETTCCY, PRICETOL, CALLTOPAR, PUTTOPAR, 
 MINDENOM, MININCREMENT, LINKSECID, INTCCY, INTEXCHRATE_8, 
 INTEXCHTERMS, SECMSIC, REPOFLAG, EXDIVDAYS, DCPRICEIND, 
 FINCENT, EXERCISEDAYS, INTENDDATERULE, SHORTCOUPIND, EMTAIND, 
 PUBLISHDAYS, ANNPERS, FIXPERS, FIXRATE_8, CASHDECS, 
 AIDECS, PMTFREQ, PRINPMTFREQ, FIXFREQ, MAXMFIX_8, 
 MAXMLIFE_8, INTRNDRULE, MININCRMT, NOAMORTS, LASTAMORT_8, 
 PITYPE, UPDATECOUNTER, PHYSDELIND, DVPIND, RECORDDATEIND, 
 PERRATEFLOOR_12, LIFERATEFLOOR_12, DELAYDAYS, PMTDAY, SETTLECLASS, 
 PMTCAP_12, POOLNO, CASHFLOWIND, PREPMTMODEL, WITHTAXRATE_12, 
 FACTSECIND, AMT1, AMT2, RATE1_12, RATE2_12, 
 DATE1, DATE2)
AS 
select "SECID","ACCTNGTYPE","CALLDATE","CALLPRICE_8","CLSGINDXRATE_8","CONVCOUPRATE_8","CONVDATE","COUPONNO","COUPRATE_8","COUPENDDATE","CCY","DENOM","DESCR","ENDTIME","FIRSTIPAYDATE","FIXCCY","GUARANTOR","INFRATECODE","INITINDEXRATE_8","BASIS","INTCALCRULE","INTPAYCYCLE","INTPAYRULE","RATECODE","ISSDATE","ISSUER","LASTIPAYDATE","LSTMNTDATE","MARKMAKIND","MDATE","MUTFUNDIND","NORMCOUPPERIOD","PARAMT","PRICEDECS","PRICERNDRULE","PRODUCT","PRODTYPE","PUTDATE","PUTPRICE_8","RATEDECS","RATERNDRULE","RATETOL","REDEMPAMT","REPOCOLLPCT","SERIES","SETTDAYS","SPREADRATE_8","STARTTIME","SYMBOLID","TAXIND","TENOR","TRADSTAT","SECUNIT","VDATE","EXCHCNO","WHACCNO","SETTCCY","PRICETOL","CALLTOPAR","PUTTOPAR","MINDENOM","MININCREMENT","LINKSECID","INTCCY","INTEXCHRATE_8","INTEXCHTERMS","SECMSIC","REPOFLAG","EXDIVDAYS","DCPRICEIND","FINCENT","EXERCISEDAYS","INTENDDATERULE","SHORTCOUPIND","EMTAIND","PUBLISHDAYS","ANNPERS","FIXPERS","FIXRATE_8","CASHDECS","AIDECS","PMTFREQ","PRINPMTFREQ","FIXFREQ","MAXMFIX_8","MAXMLIFE_8","INTRNDRULE","MININCRMT","NOAMORTS","LASTAMORT_8","PITYPE","UPDATECOUNTER","PHYSDELIND","DVPIND","RECORDDATEIND","PERRATEFLOOR_12","LIFERATEFLOOR_12","DELAYDAYS","PMTDAY","SETTLECLASS","PMTCAP_12","POOLNO","CASHFLOWIND","PREPMTMODEL","WITHTAXRATE_12","FACTSECIND","AMT1","AMT2","RATE1_12","RATE2_12","DATE1","DATE2" from secm
WITH READ ONLY
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_BLOQUEO_TITULOS
(NUMERO_AR, ORDENE_ID, FECHA_ORDEN, PRODUCTO, TIPO_PRODUCTO, 
 RIF_CLIENTE, NOMBRE_CLIENTE, TIPBLO_ID, TIPBLO_DESCRIPCION, BENEFICIARIO_ID, 
 BENEFICIARIO_NOMBRE, TITULO_ID, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_MERCADO, 
 CANTIDAD_TITULOS, MONEDA_DENOMINACION, VALOR_NOMINAL)
AS 
select 
A.NUMERO_GARANTIA, 
C.ORDENE_ID, 
TO_CHAR(C.ORDENE_PED_FE_ORDEN,'DDMMYYYY'), 
D.PDESC, 
E.DESCR, 
G.CLIENT_CEDRIF, 
G.CLIENT_NOMBRE, 
H.TIPBLO_ID, 
H.TIPBLO_DESCRIPCION, 
I.BENEFICIARIO_ID, 
I.BENEFICIARIO_NOMBRE, 
F.TITULO_ID, 
TO_CHAR(F.TITULO_FE_EMISION,'DDMMYYYY'), 
TO_CHAR(F.TITULO_FE_VENCIMIENTO,'DDMMYYYY'), 
J.TITULOS_PRECIO_RECOMPRA, 
A.TITCUS_CANTIDAD, 
F.TITULO_MONEDA_NEG, 
A.TITCUS_CANTIDAD 
FROM 
INFI_TB_704_TITULOS_BLOQUEO A INNER JOIN INFI_TB_206_ORDENES_TITULOS B ON A.TITULO_ID = B.TITULO_ID 
INNER JOIN INFI_TB_204_ORDENES C ON B.ORDENE_ID = C.ORDENE_ID AND C.TRANSA_ID='BLOQUEO_TITULOS' 
INNER JOIN INFI_TB_100_TITULOS F ON F.TITULO_ID = A.TITULO_ID 
INNER JOIN INFI_VI_PRODUCTO D ON F.PRODUCT = D.PCODE 
INNER JOIN INFI_VI_TIPO_PRODUCTO E ON F.PRODUCT = E.PRODCODE AND F.PRODTYPE = E.TYPE 
INNER JOIN INFI_TB_201_CTES G ON G.CLIENT_ID = C.CLIENT_ID AND A.CLIENT_ID = C.CLIENT_ID 
INNER JOIN INFI_TB_700_TIPO_BLOQUEO H ON A.TIPBLO_ID = H.TIPBLO_ID 
INNER JOIN INFI_TB_039_BENEFICIARIOS I ON A.BENEFICIARIO_ID = I.BENEFICIARIO_ID 
LEFT JOIN INFI_TB_120_TITULOS_PREC_RCMP J ON A.TITULO_ID = J.TITULO_ID AND F.TITULO_MONEDA_NEG = J.MONEDA_ID AND A.TITCUS_CANTIDAD BETWEEN J.TITULO_RANGO_INVERTIDO_DESDE AND J.TITULO_RANGO_INVERTIDO_HASTA 
INNER JOIN INFI_TB_206_ORDENES_TITULOS K ON A.TITULO_ID = K.TITULO_ID AND C.ORDENE_ID = K.ORDENE_ID
/

COMMENT ON TABLE ADM_INFI.INFI_VI_BLOQUEO_TITULOS IS 'Representa informacin m¿s detallada acerca de los t¿tulos bloqueados que poseen los clientes'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.NUMERO_AR IS 'N¿mero de ar'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.ORDENE_ID IS 'Id de la orden de bloqueo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.FECHA_ORDEN IS 'Fecha en que se efectu el bloqueo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.PRODUCTO IS 'Producto asociado al t¿tulo bloqueado'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.TIPO_PRODUCTO IS 'Tipo de producto asociado al t¿tulo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.RIF_CLIENTE IS 'Rif o c¿dula del cliente'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.NOMBRE_CLIENTE IS 'Nombre del cliente'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.TIPBLO_ID IS 'Id de tipo de bloqueo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.TIPBLO_DESCRIPCION IS 'Descripcin del tipo de bloqueo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.BENEFICIARIO_ID IS 'Id de beneficiario'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.BENEFICIARIO_NOMBRE IS 'Descripcin del beneficiario del bloqueo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.TITULO_ID IS 'Id del t¿tulo o clave valor'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.FECHA_EMISION IS 'Fecha de emisin del t¿tulo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.FECHA_VENCIMIENTO IS 'Fecha de vencimiento del t¿tulo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.PRECIO_MERCADO IS 'Precio de mercado configurado en INFI'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.CANTIDAD_TITULOS IS 'Representa la cantidad de t¿tulos bloqueado'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.MONEDA_DENOMINACION IS 'Moneda de denominacin del t¿tulo'
/

COMMENT ON COLUMN ADM_INFI.INFI_VI_BLOQUEO_TITULOS.VALOR_NOMINAL IS 'Valor nominal'
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_CALENDARIO
(CALEN_FECHA_NO_TRAB, CALEN_MOTIVO)
AS 
select CAL_FECHA, CAL_MOTIVO from REN_CALENDARIO
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_CONTRATADOS_BDV
(CONTRATADOS_CED, COMPANIA, GRUPOPAGO, NOMBRE)
AS 
SELECT EMPLID,COMPANY,PAYGROUP,NAME FROM ps_rrhh_view
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_CUST
(CNO, CMNE, BIC, CCODE, SIC, 
 SN, CFN1, CFN2, CA1, CA2, 
 CA3, CA4, CA5, CTYPE, CPOST, 
 LSTMNTDTE, UCCODE, BIRTHDATE, TAXID, ACCTNGTYPE)
AS 
select "CNO","CMNE","BIC","CCODE","SIC","SN","CFN1","CFN2","CA1","CA2","CA3","CA4","CA5","CTYPE","CPOST","LSTMNTDTE","UCCODE","BIRTHDATE","TAXID","ACCTNGTYPE" from cust with read only
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_MONEDAS
(MONEDA_ID, MONEDA_DESCRIPCION, MONEDA_STATUS, MONEDA_IN_LOCAL, MONEDA_IN_EXCHANGE, 
 MONEDA_SIGLAS)
AS 
SELECT DIV_CDDIVISS,DIV_CDDIVISS,1 AS MONEDA_STATUS,DECODE(DIV_CDDIVISS,'VEF',1,0) AS MONEDA_IN_LOCAL,0 AS MONEDA_IN_EXCHANGE,DIV_CDDIVISS FROM REN_DIVISA WHERE DIV_INDCOTDI='S'
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_MONEDAS_ISO
(MONEDA_ID, MONEDA_DESCRIPCION, MONEDA_LOCAL)
AS 
SELECT  DIV_CDDIVBE, --Código ISO númerico --
           DIV_CDDIVISS, --Código ISO alfanúmerico --
           DECODE (DIV_CDDIVISS, 'VEF', 1, 0) AS MONEDA_IN_LOCAL
   FROM REN_DIVISA
   WHERE DIV_INDCOTDI = 'S'
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_OPER
(BR, OPER, OPERNAME, AUTHAMT, SIGNEDON, 
 PCID, LSTMNTDTE, SIGNONID, DEPARTMENT, LOCATION, 
 PHONENUMBER, EMPLOYEENUMBER, CONTACT, EMAIL, FAXNUMBER, 
 TEXT1, TEXT2, DATE1, DATE2, AMOUNT1, 
 AMOUNT2, GUID)
AS 
select "BR","OPER","OPERNAME","AUTHAMT","SIGNEDON","PCID","LSTMNTDTE","SIGNONID","DEPARTMENT","LOCATION","PHONENUMBER","EMPLOYEENUMBER","CONTACT","EMAIL","FAXNUMBER","TEXT1","TEXT2","DATE1","DATE2","AMOUNT1","AMOUNT2","GUID" from oper
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_PAISES
(TAB_COD_TABLA, TAB_CAMPO_CLAVE, TAB_DESCRIPCION)
AS 
SELECT "TAB_COD_TABLA","TAB_CAMPO_CLAVE","TAB_DESCRIPCION" FROM REN_TABLAS_CORPORATIVAS WHERE TAB_COD_TABLA='0112'
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_PRECIO_MERCADO
(SECID, TITULOS_PRECIO_MERCADO)
AS 
SELECT A.SECID, A.CLPRICE_8 
FROM SECP A, 
(
  SELECT MAX(B.EFFDATE) EFFDATE
  FROM SECP B 
  WHERE b.br = '99'
) C
WHERE A.EFFDATE = C.EFFDATE
AND A.br = '99'
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_PRODUCTO
(PCODE, PDESC, SYS, LSTMNTDTE)
AS 
SELECT "PCODE","PDESC","SYS","LSTMNTDTE" FROM PROD
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_TASA_CAM_CIERRE_DIARIO
(TCC_FECHA_CAMBIO, TCC_CODIGO_DIVISA, TCC_IND_DIVISA, TCC_IND_COT, TCC_TASA_CAMBIO, 
 TCC_TASA_CAMBIO_COMPRA, TCC_TASA_CAMBIO_VENTA)
AS 
SELECT "TCC_FECHA_CAMBIO",
          "TCC_CODIGO_DIVISA",
          "TCC_IND_DIVISA",
          "TCC_IND_COT",
          "TCC_TASA_CAMBIO",
          "TCC_TASA_CAMBIO_COMPRA",
          "TCC_TASA_CAMBIO_VENTA"
     FROM REN_TASA_CAMBIO_CIERRE_DIARIO
/


CREATE OR REPLACE VIEW ADM_INFI.INFI_VI_TIPO_PRODUCTO
(PRODCODE, TYPE, DESCR, LSTMNTDTE, AL)
AS 
SELECT "PRODCODE","TYPE","DESCR","LSTMNTDTE","AL" FROM TYPE
/


CREATE PUBLIC SYNONYM INFI_TB_100_TITULOS FOR ADM_INFI.INFI_TB_100_TITULOS
/


CREATE PUBLIC SYNONYM INFI_VI_100_TITULOS FOR ADM_INFI.INFI_VI_100_TITULOS
/


CREATE PUBLIC SYNONYM INFI_VI_BLOQUEO_TITULOS FOR ADM_INFI.INFI_VI_BLOQUEO_TITULOS
/


CREATE PUBLIC SYNONYM INFI_VI_CALENDARIO FOR ADM_INFI.INFI_VI_CALENDARIO
/


CREATE PUBLIC SYNONYM INFI_VI_CONTRATADOS_BDV FOR ADM_INFI.INFI_VI_CONTRATADOS_BDV
/


CREATE PUBLIC SYNONYM INFI_VI_CUST FOR ADM_INFI.INFI_VI_CUST
/


CREATE PUBLIC SYNONYM INFI_VI_MONEDAS FOR ADM_INFI.INFI_VI_MONEDAS
/


CREATE PUBLIC SYNONYM INFI_VI_OPER FOR ADM_INFI.INFI_VI_OPER
/


CREATE PUBLIC SYNONYM INFI_VI_PAISES FOR ADM_INFI.INFI_VI_PAISES
/


CREATE PUBLIC SYNONYM INFI_VI_PRECIO_MERCADO FOR ADM_INFI.INFI_VI_PRECIO_MERCADO
/


CREATE PUBLIC SYNONYM INFI_VI_PRODUCTO FOR ADM_INFI.INFI_VI_PRODUCTO
/


CREATE PUBLIC SYNONYM INFI_VI_TASA_CAM_CIERRE_DIARIO FOR ADM_INFI.INFI_VI_TASA_CAM_CIERRE_DIARIO
/


CREATE PUBLIC SYNONYM INFI_VI_TIPO_PRODUCTO FOR ADM_INFI.INFI_VI_TIPO_PRODUCTO
/


GRANT DELETE ON  ADM_INFI.INFI_VI_TASA_CAM_CIERRE_DIARIO TO USU_INFI
/

GRANT DELETE, INSERT ON  ADM_INFI.INFI_VI_MONEDAS TO USU_INFI
/

GRANT INSERT ON  ADM_INFI.INFI_VI_TASA_CAM_CIERRE_DIARIO TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_MONEDAS TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_OPER TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_PAISES TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_PRECIO_MERCADO TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_PRODUCTO TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_CUST TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_CALENDARIO TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_TIPO_PRODUCTO TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_TB_100_TITULOS TO USU_INFI
/

GRANT SELECT ON  ADM_INFI.INFI_VI_100_TITULOS TO USU_INFI
/

GRANT SELECT, UPDATE ON  ADM_INFI.INFI_VI_TASA_CAM_CIERRE_DIARIO TO USU_INFI
/

GRANT UPDATE ON  ADM_INFI.INFI_VI_MONEDAS TO USU_INFI
/

